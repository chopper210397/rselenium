empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
remote_driver$click(buttonId = "RIGHT")
remote_driver$open()
driver <- rsDriver(browser = c("firefox"),port = 4447L)
library(RSelenium)
library(rvest)
library(tidyverse)
library(lubridate)
driver <- rsDriver(browser = c("firefox"),port = 4447L)
remote_driver <- driver[["client"]]
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
remDr <- remoteDriver(extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
))
remDr <- remoteDriver(extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
))
remDr$open()
rm(remDr)
driver <- rsDriver(browser = c("firefox"),port = 4447L,extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
))
driver <- rsDriver(browser = c("firefox"),port = 4445L,extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
))
remote_driver <- driver[["client"]]
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(5)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
install.packages("Rtools")
driver <- rsDriver(browser = c("firefox"),port = 4444L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
))
remote_driver <- driver[["client"]]
Sys.sleep(5)
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(5)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
driver <- rsDriver(browser = c("firefox"),port = 4444L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"='application/xls')
))
driver <- rsDriver(browser = c("firefox"),port = 4443L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"='application/xls')
))
remote_driver <- driver[["client"]]
Sys.sleep(5)
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(5)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
wd <- getwd()
cprof <- getChromeProfile(wd, "Profile 1")
remDr <- rsDriver(browserName= "chrome", extraCapabilities = cprof)
wd <- getwd()
cprof <- getChromeProfile(wd, "Profile 1")
remDr <- remoteDriver(browserName= "chrome", extraCapabilities = cprof)
remDr$open
remote_driver <- driver[["client"]]
remote_driver <- remDr[["client"]]
remote_driver$open
remDr$open
# install.packages("Rtools")
makeFirefoxProfile(opts)
install.packages("Rtools")
eCaps <- list(
chromeOptions =
list(prefs = list(
"profile.default_content_settings.popups" = 0L,
"download.prompt_for_download" = FALSE,
"download.default_directory" = "C:/temp/chromeDL"
)
)
)
rD <- rsDriver(extraCapabilities = eCaps)
rD <- rsDriver(extraCapabilities = eCaps, port = 4565L)
remDr <- rD$client
rD <- rsDriver(extraCapabilities = eCaps, port = 4565L)
eCaps <- list(
chromeOptions =
list(prefs = list(
"profile.default_content_settings.popups" = 0L,
"download.prompt_for_download" = FALSE,
"download.default_directory" = "C:/temp/chromeDL"
)
)
)
rD <- rsDriver(extraCapabilities = eCaps, port = 4565L)
rD <- rsDriver(extraCapabilities = eCaps, port = 4567L)
rD <- rsDriver(extraCapabilities = eCaps, port = 4568L)
driver <- rsDriver(browser = c("firefox"),port = 4443L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.ms-excel")
))
driver <- rsDriver(browser = c("firefox"),port = 4442L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.ms-excel")
))
remote_driver <- driver[["client"]]
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(5)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
library(RSelenium)
library(rvest)
library(tidyverse)
library(lubridate)
Sys.sleep(10)
# este pagina es la que nos brinda la parte de application/vnd.... , esto es necesario ponerlo para que el buscador de firefox no nos pregunte si queremos
# guardar o abrir el archivo, porque eso mata todo el codigo, mediante este codigo, especifico para documentos con terminación xls, podemos saltar el pop-up
# y descargar directamente en la carpeta de descargas o downloads de la página.
# https://www.freeformatter.com/mime-types-list.html
driver <- rsDriver(browser = c("firefox"),port = 4441L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.ms-excel")
))
remote_driver <- driver[["client"]]
# install.packages("Rtools") por seacaso
Sys.sleep(6)
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
Sys.sleep(7)
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# CODIGOS QUE PUEDEN SER UTILES MAS ADELANTE
# empresa$highlightElement()
# options<-empresa$selectTag()
# options$text
# options$value
# options$selected
# options$elements[[2]]$clickElement()
# options$elements
# rm(empresa)
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(7)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# downloadexcel<-remote_driver$findElement(using = "class",value = "Boton")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
# downloadexcel<-remote_driver$findElement(using = "xpath",value = "//*[@id='ctl00_ContentPlaceHolder1_ibtn_Excel']")
# downloadexcel<-remote_driver$findElement(using = "css",value = "html.js.canvas.canvastext.geolocation.crosswindowmessaging.no-websqldatabase.indexeddb.hashchange.historymanagement.draganddrop.websockets.rgba.hsla.multiplebgs.backgroundsize.borderimage.borderradius.boxshadow.opacity.cssanimations.csscolumns.cssgradients.no-cssreflections.csstransforms.csstransforms3d.csstransitions.video.audio.localstorage.sessionstorage.webworkers.no-applicationcache.svg.smil.svgclippaths.fontface body.sidebar-left.chart div#container form#aspnetForm div#page div#page-content.container_12 div#contenidoss div.grid_12 div div.box div.div_bloque input#ctl00_ContentPlaceHolder1_ibtn_Excel.Boton")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
# downloadexcel<-remote_driver$findElement(using = "name",value = "ctl00$ContentPlaceHolder1$ibtn_Excel")
# downloadexcel<-remote_driver$findElement(using = "partial link text",value = "../App_Themes/COMERCIO/Images/botones/ico_excel.png")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//*[@id='ctl00_ContentPlaceHolder1_ibtn_Excel']")
# downloadexcel$getElementLocation()
# downloadexcel<-remote_driver$mouseMoveToLocation()
Sys.sleep(2)
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
# CON ESTO HASTA AQUI YA DEBERIA ESTAR DESCARGADO EL EXCEL
############################################################################################
############################################################################################
############    TRABAJANDO LA DATA    ############    TRABAJANDO LA DATA    ################
############################################################################################
############################################################################################
remDr <- remoteDriver(extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
))
remDr$open()
url <- "http://www.iwh-halle.de/e/fdz/IntBankLib/data/downloads/databases.xlsx"
remDr$navigate(url)
file.exists(file.path("~/Downloads/", basename(url)))
rm(remDr)
remote_driver$open
library(readxl)
library(lubridate)
year()
year(today())
month(today())
year(today()),month(today()),day(today())
paste0("C:\Users\LBarrios\Downloads\FacMet_",year(today()),month(today()),day(today()))
paste0("C:\Users\LBarrios\Downloads\FacMet_",year(today()),month(today()),day(today()))
paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()))
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today())))
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"))
paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls")
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"))
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"))
View(metronic)
metronic<-read_xlsx(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"))
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"))
############################################################################################
############################################################################################
############    TRABAJANDO LA DATA    ############    TRABAJANDO LA DATA    ################
############################################################################################
############################################################################################
install.packages("read.xlsx2")
metronic<-read_xlsx(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),"FacturacionMetronic", rowIndex=6:6000 )
metronic<-read_xlsx(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
metronic<-read_xls(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
View(metronic)
metronic<-read_xlsx(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
metronic<-read_excel(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
"FacturacionMetronic",
skip = 5 )
View(metronic)
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
sheet = "FacturacionMetronic",
skip = 5 )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
sheet = "FacturacionMetronic",
skip = 5 )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
sheet = "FacturacionMetronic",
range = A6:J10 )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
sheet = "FacturacionMetronic",
range = A7:J10 )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
sheet = "FacturacionMetronic",
range = "A7:J10" )
View(metronic)
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "A7:J10" )
metronic<-read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "A7:J10" )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "A7:J10" )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturcionMetronicA7:J10" )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturcionMetronicA7:J10" )
metronic<-read_excel(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
View(metronic)
View(metronic)
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronicA7:J10" )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10" )
View(metronic)
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10" )
# si esta leyendo el archivo cuando elimino la columna f y l
metronic<-read_excel(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
# si esta leyendo el archivo cuando elimino la columna f y l
metronic<-read_excel(paste0("C:\\Users\\LBarrios\\Downloads\\FacMet_",year(today()),month(today()),day(today()),".xls"),
"FacturacionMetronic",
skip = 5 )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10" )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10",fillMergedCells=TRUE )
metronic<-read_xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10",fillMergedCells=TRUE )
metronic<-read_xlsx("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls",
range = "FacturacionMetronic!A7:J10",fillMergedCells=TRUE )
data <- read.xlsx(xlsxFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xlsx(xlsxFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xlsx(xlsFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xlsx(xlsFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xls(xlsFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read_xlsx(xlsFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
install.packages("openxlsx")
library(openxlsx)
data <- read_xlsx(xlsxFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xlsx(xlsxFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
data <- read.xlsx(xlsxFile = "C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
# read, fill, and collapse 4 rows of multiple headers from merged cells
headers <- read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", col_names = FALSE, na="..", n_max = 4)
# read, fill, and collapse 4 rows of multiple headers from merged cells
headers <- read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", col_names = FALSE, na="..", n_max = 100)
# read, fill, and collapse 4 rows of multiple headers from merged cells
headers <- read_excel("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", col_names = FALSE, na="..", n_max = 100)
# fill only works down or up, so have to transpose headers
long_headers = data.frame(t(headers))
long_headers <- fill(long_headers,1:4) # all four columns
headers <- data.frame(t(long_headers)) # back to vertical.
install.packages("TableToLongForm")
library(TableToLongForm)
TTLFaliasAdd("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls")
install.packages("read.table")
data<-read_excel("FacMet_20211125.xls")
getwd()
setwd()
setwd("C:\\Users\\LBarrios\\Downloads")
getwd()
data<-read_excel("FacMet_20211125.xls")
View(data)
## probando mas metodos
data <- read.xls("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", fillMergedCells = TRUE, colNames = FALSE)
install.packages("read.xls")
metronic<-read_xls("FacMet_20211125.xls")
metronic<-read_xls("FacMet_20211125.xls",range = "D4:D8" )
metronic<-read_xls("FacMet_20211125.xls",col_names = FALSE )
metronic<-read_xls("FacMet_20211125.xls",col_names = FALSE )
metronic<-read_xls("FacMet_20211125.xls",col_types = "skip" )
rm(metronic)
metronic<-read_xls("FacMet_20211125.xls",col_types = "text" )
rm(metronic)
metronic<-read_xls("FacMet_20211125.xls",col_types = "guess" )
metronic<-read_xls("FacMet_20211125.xls",col_types = "numerical" )
metronic<-read_xls("FacMet_20211125.xls",col_types = "logical" )
metronic<-read_xls("FacMet_20211125.xls",col_types = "text" )
col_types$options
metronic<-read_xls("FacMet_20211125.xls",na = "---" )
View(metronic)
metronic<-read_xls("FacMet_20211125.xls",trim_ws = FALSE )
rm(metronic)
metronic<-read_xls("FacMet_20211125.xls",skip = 8)
##################################################33333
install.packages("XLConnect")
library(XLConnect)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1, endRow = 10,
startCol = 1, endCol = 3)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1, endRow = 10,
startCol = 1, endCol = 3)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1, endRow = 10,
startCol = 1, endCol = 3)
View(data)
View(data)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1, endRow = ,
startCol = 1, endCol = 3)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1,
startCol = 1, endCol = 3)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1,
startCol = 1)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 1,
startCol = 1)
View(data)
View(data)
data <- readWorksheetFromFile("C:\\Users\\LBarrios\\Downloads\\FacMet_20211125.xls", sheet = "FacturacionMetronic",
startRow = 6,
startCol = 1)
View(data)
library(dplyr)
data %>% select(-Col6)
data2<-data %>% select(-Col6,-Col12)
View(data2)
ncol(data)
ncol(data2)
rm(data2)
# retirando las columnas que eran merge de las otras
data<-data %>% select(-Col6,-Col12)
data %>% filter(Periodo="202111")
data %>% filter(Periodo=="202111")
data2<-data %>% filter(Periodo=="202111")
data3<-data2 %>% filter(Artículo!="MACUVIT X 60 CAPSULAS")
rm(data3)
library(RSelenium)
library(rvest)
library(tidyverse)
library(lubridate)
library(readxl)
library(lubridate)
# este pagina es la que nos brinda la parte de application/vnd.... , esto es necesario ponerlo para que el buscador de firefox no nos pregunte si queremos
# guardar o abrir el archivo, porque eso mata todo el codigo, mediante este codigo, especifico para documentos con terminación xls, podemos saltar el pop-up
# y descargar directamente en la carpeta de descargas o downloads de la página.
# https://www.freeformatter.com/mime-types-list.html
driver <- rsDriver(browser = c("firefox"),port = 4440L, extraCapabilities = makeFirefoxProfile(list(
"browser.helperApps.neverAsk.saveToDisk"="application/vnd.ms-excel")
))
remote_driver <- driver[["client"]]
# install.packages("Rtools") por seacaso
Sys.sleep(6)
remote_driver$navigate("http://www.lansierweb.com:9300/FACTURACION/FacturacionMetronic.aspx?JER=divMenuLBTR_1_01.02")
Sys.sleep(7)
# con esto hacemos click en LABORATORIOS LANSIER S.A.C
# FORMA GENIAL DE SELECCIONAR MEDIANTE ID Y VALUE, NO SABIA HACERLA ANTES
empresa<- remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
empresa$clickElement()
# CODIGOS QUE PUEDEN SER UTILES MAS ADELANTE
# empresa$highlightElement()
# options<-empresa$selectTag()
# options$text
# options$value
# options$selected
# options$elements[[2]]$clickElement()
# options$elements
# rm(empresa)
# USUARIO
username<-remote_driver$findElement(using = "id", value = "txtUsuario")
username$sendKeysToElement(list("ABA"))
# PASSWORD
psswd<-remote_driver$findElement(using = "id",value = "txtClave")
psswd$sendKeysToElement(list("72722698","\uE007"))
# ahora que ya entre a la pagina solo falta hacer click en  descargar excel
# DESCARGAR EXCEL
# PARA SELECCIONAR EL EXCEL AL PARECER CUALQUIERA DE ESTOS COMANDOS ME ES VALIDO, MAS ADELANTE PROBAR DE NUEVO
Sys.sleep(7)
downloadexcel<-remote_driver$findElement(using = "id",value = "ctl00_ContentPlaceHolder1_ibtn_Excel")
# downloadexcel<-remote_driver$findElement(using = "class",value = "Boton")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
# downloadexcel<-remote_driver$findElement(using = "xpath",value = "//*[@id='ctl00_ContentPlaceHolder1_ibtn_Excel']")
# downloadexcel<-remote_driver$findElement(using = "css",value = "html.js.canvas.canvastext.geolocation.crosswindowmessaging.no-websqldatabase.indexeddb.hashchange.historymanagement.draganddrop.websockets.rgba.hsla.multiplebgs.backgroundsize.borderimage.borderradius.boxshadow.opacity.cssanimations.csscolumns.cssgradients.no-cssreflections.csstransforms.csstransforms3d.csstransitions.video.audio.localstorage.sessionstorage.webworkers.no-applicationcache.svg.smil.svgclippaths.fontface body.sidebar-left.chart div#container form#aspnetForm div#page div#page-content.container_12 div#contenidoss div.grid_12 div div.box div.div_bloque input#ctl00_ContentPlaceHolder1_ibtn_Excel.Boton")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//select[@id='ddlEmpresa']/option[@value='1']")
# downloadexcel<-remote_driver$findElement(using = "name",value = "ctl00$ContentPlaceHolder1$ibtn_Excel")
# downloadexcel<-remote_driver$findElement(using = "partial link text",value = "../App_Themes/COMERCIO/Images/botones/ico_excel.png")
# downloadexcel<-remote_driver$findElement(using = 'xpath', "//*[@id='ctl00_ContentPlaceHolder1_ibtn_Excel']")
# downloadexcel$getElementLocation()
# downloadexcel<-remote_driver$mouseMoveToLocation()
Sys.sleep(2)
# CLICK DESCARGA EXCEL: ESTAMOS USANDO OTRO METODO DISTINTO AL CLICK ELEMENT ANTERIOR, AHORA ESTAMOS HACIENDO OTRO METODO, SITUANDO EL MOUSE EN LA COORDENADA Y DANDOLE CLICK
remote_driver$mouseMoveToLocation(webElement = downloadexcel)
remote_driver$click(buttonId = "RIGHT")
# CON ESTO HASTA AQUI YA DEBERIA ESTAR DESCARGADO EL EXCEL
